{% extends 'main.html' %}
{% block content %}

<div class="container-fluid py-4">

  <!-- Page Header -->
  <div class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-2">
    <div>
      <h4 class="mb-1 fw-semibold d-flex align-items-center gap-2">
        <i class="bi bi-box-seam text-primary"></i>
        Product Detail
      </h4>
      <div class="text-muted small">
        <span class="me-2">Inventory • Sales Management</span> |
        <span class="ms-2">SKU: {{ product.slug }}</span>
      </div>
    </div>
    <div class="d-flex flex-wrap gap-2">
      <a href="{% url 'product-update' product.slug %}" class="btn btn-sm btn-outline-primary rounded-3">
        <i class="bi bi-pencil-square me-1"></i> Edit
      </a>
      <a href="{% url 'product-delete' product.slug %}" class="btn btn-sm btn-outline-danger rounded-3">
        <i class="bi bi-trash me-1"></i> Delete
      </a>
      <a href="{% url 'product-list' %}" class="btn btn-sm btn-light border rounded-3">
        <i class="bi bi-arrow-left me-1"></i> Back to products
      </a>
    </div>
  </div>

  <div class="row g-4">

    <!-- Left: Main product info -->
    <div class="col-lg-8 col-xl-9">
      <div class="card border-0 shadow-sm rounded-4 h-100">
        <div class="card-header bg-white border-0 rounded-top-4 py-3 d-flex justify-content-between align-items-center px-3 px-lg-4">
          <div class="d-flex align-items-center gap-3">
            <div class="bg-primary bg-opacity-10 text-primary rounded-3 d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
              <i class="bi bi-box-seam fs-5"></i>
            </div>
            <div>
              <h5 class="mb-0 fw-semibold">{{ product.name|capfirst }}</h5>
              <div class="small text-muted">
                Category:
                {% if product.category %}
                  <span class="badge bg-light text-secondary border">{{ product.category.name }}</span>
                {% else %}
                  <span class="text-muted">Uncategorized</span>
                {% endif %}
              </div>
            </div>
          </div>
          <div class="text-end">
            <div class="text-muted small">Current Price</div>
            <div class="fs-5 fw-bold text-primary">₱{{ product.selling_price|floatformat:2 }}</div>
          </div>
        </div>

        <div class="card-body p-4">

          <!-- Quick stats row -->
          <div class="row g-3 mb-3">
            <div class="col-md-4">
              <div class="border rounded-3 p-3 bg-light">
                <div class="text-muted small mb-1">Selling Price</div>
                <div class="fw-semibold">₱{{ product.selling_price|floatformat:2 }}</div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="border rounded-3 p-3 bg-light">
                <div class="text-muted small mb-1">Cost</div>
                <div class="fw-semibold">₱{{ product.cost_price|default:"0.00"|floatformat:2 }}</div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="border rounded-3 p-3 bg-light">
                <div class="text-muted small mb-1">Stock on Hand</div>
                <div class="fw-semibold">{{ product.stock }}</div>
              </div>
            </div>
          </div>

          <!-- Description -->
          <div class="border-top pt-3 mt-3">
            {% if product.description %}
              <h6 class="text-muted mb-2">Description</h6>
              <div class="p-3 border rounded-3 bg-light">
                {{ product.description|linebreaksbr }}
              </div>
            {% else %}
              <div class="text-muted fst-italic small">
                No description provided for this product.
              </div>
            {% endif %}
          </div>

        </div>
      </div>
    </div>

    <!-- Right: POS-style context panel -->
    <div class="col-lg-4 col-xl-3">
      <div class="card border-0 shadow-sm rounded-4 h-100">

        <div class="card-header bg-dark text-white rounded-top-4 px-3 px-lg-4 py-2 py-lg-3 d-flex justify-content-between align-items-center">
          <div class="d-flex align-items-center gap-2">
            <i class="bi bi-speedometer2"></i>
            <h6 class="mb-0 fw-semibold">Product snapshot</h6>
          </div>
          <small class="text-white-50 d-none d-sm-inline">Quick view</small>
        </div>

        <div class="card-body px-3 px-lg-4 py-3 small d-flex flex-column gap-3">

          <!-- Stock level + status -->
          <div class="border rounded-3 px-2 py-2 bg-light">
            <div class="d-flex justify-content-between align-items-center mb-1">
              <span class="text-muted text-uppercase small">Stock level</span>
              {% if product.stock <= 0 %}
                <span class="badge bg-danger-subtle text-danger rounded-pill px-3">
                  Out of stock
                </span>
              {% elif product.stock < 10 %}
                <span class="badge bg-warning-subtle text-warning rounded-pill px-3">
                  Low stock
                </span>
              {% else %}
                <span class="badge bg-success-subtle text-success rounded-pill px-3">
                  In stock
                </span>
              {% endif %}
            </div>
            <div class="fs-5 fw-semibold
              {% if product.stock <= 0 %}
                text-danger
              {% elif product.stock < 10 %}
                text-warning
              {% else %}
                text-success
              {% endif %}
            ">
              {{ product.stock }} units
            </div>
            <div class="small text-muted">
              Use this when deciding reorder timing and stock adjustments.
            </div>
          </div>

          <!-- Value and revenue overview -->
          <div class="border rounded-3 px-2 py-2 bg-body-tertiary">
            <div class="text-muted text-uppercase small mb-1">Value overview</div>
            <div class="d-flex justify-content-between small">
              <span>Stock value (cost):</span>
              <span>
                ₱{{ product.stock }} × ₱{{ product.cost_price|default:"0.00"|floatformat:2 }}
              </span>
            </div>
            <div class="d-flex justify-content-between small">
              <span>Potential revenue:</span>
              <span>
                ₱{{ product.stock }} × ₱{{ product.selling_price|default:"0.00"|floatformat:2 }}
              </span>
            </div>
            <div class="small text-muted mt-1">
              Handy for checking how much value sits in this item on the shelf.
            </div>
          </div>

          <!-- Status legend / hints -->
          <div class="border rounded-3 px-2 py-2">
            <div class="text-muted text-uppercase small mb-1">How to use this info</div>
            <ul class="small text-muted mb-0 ps-3">
              <li>Low stock suggests reviewing reorder settings.</li>
              <li>Large stock value may indicate overstocking.</li>
              <li>Check cost vs. price before running promotions.</li>
            </ul>
          </div>

          <!-- POS-style tip -->
          <div class="alert alert-light border-0 mb-0">
            <div class="d-flex">
              <div class="me-2">
                <i class="bi bi-lightning-charge text-warning"></i>
              </div>
              <div>
                <div class="fw-semibold small">Next actions</div>
                <div class="small text-muted">
                  If this product drives key sales, keep it in the “In stock” range and review pricing whenever supplier costs change.
                </div>
              </div>
            </div>
          </div>

        </div>

      </div>
    </div>

  </div>
</div>

{% endblock content %}
